<!DOCTYPE html>
<html>
<head>
    <!-- meta tag goes here -->
    <title>EG_Editor</title>
    <!--custom stylesheets for jquery -->
    <link rel="stylesheet" type="text/css" href="../view/styles.css"/>
    <!-- Bootstrap core CSS-->
    <link rel="stylesheet" href="../libs/bootstrap/bootstrap.css"/>
    <!-- Bootstrap javascript link-->
    <script src="../libs/bootstrap/bootstrap.js"></script>
    <!-- link to joint.js stylesheet-->
    <link rel="stylesheet" href="../css/joint.css" />
    <!--link to minified jquery -->
    <script src="../js/jquery.min.js"></script>
    <!--link to lodash.js-->
    <script src="../js/lodash.min.js"></script>
    <!--link to backbone.js-->
    <script src="../js/backbone-min.js"></script>
    <!--link to joint.js-->
    <script src="../js/joint.js"></script>
    <!--link to jointScript.js-->
    <script src="../view/jointScript.js"></script>
</head>
<body>
<div class="page-header">
    <h1>EG Editor -UAH-<small> SMAP</small></h1>
    <img id="uah" src="../images/uahLogo.png" />

</div>
<form>
        <label class="label label-primary" for="drawType">Enter Expression (e, c, p, q):</label>
    <div class="input-group">
        <input id="drawType" type="text" class="form-control" placeholder="Enter Expression" aria-describedby="basic-addon2">
        <span  class="input-group-addon" id="drawC" onclick="return OnClickDraw();">Submit</span>
        <span  class="input-group-addon" id="clear" onclick="return clearArea();">Clear</span>
        <span  class="input-group-addon" id="save">Save</span>
    </div>
</form>
<br>
<p></p>
<div class="panel panel-primary">
    <div class="panel-body">
        <section>
            <div id="myholder">
                <script type="text/javascript">

                    var graph = new joint.dia.Graph;
                    //var paper = new joint.dia.Paper({ el: $('#paper-parent-expand'), width: 650, height: 250, gridSize: 1, model: graph });
                    var paper = new joint.dia.Paper({ el: $('#myholder'), width: 1174, height: 420, gridSize: 1, model: graph });

                    var r1 = new joint.shapes.basic.Rect({
                        position: { x: 20, y: 20 },
                        size: { width: 150, height: 150 },
                        attrs: { rect: { fill: '#E74C3C', rx: 20, ry: 20 }, text: { text: '' } }
                    });
                    var r2 = new joint.shapes.basic.Rect({
                        position: { x: 40, y: 25 },
                        size: { width: 50, height: 40 },
                        attrs: { rect: { fill: '#F1C40F', rx: 20, ry: 20 }, text: { text: 'A' } }
                    });
                    var r3 = new joint.shapes.basic.Rect({
                        position: { x: 110, y: 60 },
                        size: { width: 50, height: 40 },
                        attrs: { rect: { fill: '#9B59B6', rx: 20, ry: 20 }, text: { text: 'B' } }
                    });
                    var r4 = new joint.shapes.basic.Rect({
                        position: { x: 200, y: 80 },
                        size: { width: 50, height: 40 },
                        attrs: { rect: { fill: '#9B59B6', rx: 20, ry: 20 }, text: { text: 'C' } }
                    });

                    r1.embed(r2);
                    r1.embed(r3);
                    graph.addCells([r1, r2, r3, r4]);

                    graph.on('change:size', function(cell, newPosition, opt) {

                        if (opt.skipParentHandler) return;

                        if (cell.get('embeds') && cell.get('embeds').length) {
                            // If we're manipulating a parent element, let's store
                            // it's original size to a special property so that
                            // we can shrink the parent element back while manipulating
                            // its children.
                            cell.set('originalSize', cell.get('size'));
                        }
                    });

                    graph.on('change:position', function(cell, newPosition, opt) {

                        if (opt.skipParentHandler) return;

                        if (cell.get('embeds') && cell.get('embeds').length) {
                            // If we're manipulating a parent element, let's store
                            // it's original position to a special property so that
                            // we can shrink the parent element back while manipulating
                            // its children.
                            cell.set('originalPosition', cell.get('position'));
                        }

                        var parentId = cell.get('parent');
                        if (!parentId) return;

                        var parent = graph.getCell(parentId);
                        var parentBbox = parent.getBBox();

                        if (!parent.get('originalPosition')) parent.set('originalPosition', parent.get('position'));
                        if (!parent.get('originalSize')) parent.set('originalSize', parent.get('size'));

                        var originalPosition = parent.get('originalPosition');
                        var originalSize = parent.get('originalSize');

                        var newX = originalPosition.x;
                        var newY = originalPosition.y;
                        var newCornerX = originalPosition.x + originalSize.width;
                        var newCornerY = originalPosition.y + originalSize.height;

                        _.each(parent.getEmbeddedCells(), function(child) {

                            var childBbox = child.getBBox();

                            if (childBbox.x < newX) { newX = childBbox.x; }
                            if (childBbox.y < newY) { newY = childBbox.y; }
                            if (childBbox.corner().x > newCornerX) { newCornerX = childBbox.corner().x; }
                            if (childBbox.corner().y > newCornerY) { newCornerY = childBbox.corner().y; }
                        });

                        // Note that we also pass a flag so that we know we shouldn't adjust the
                        // `originalPosition` and `originalSize` in our handlers as a reaction
                        // on the following `set()` call.
                        parent.set({
                            position: { x: newX, y: newY },
                            size: { width: newCornerX - newX, height: newCornerY - newY }
                        }, { skipParentHandler: true });
                    });
             </script><!--canvas id="myCanvas" --><!--/canvas-->
            </div>
            <div id="two"><h4 id="headSide1" >ADD</h4><panel id="sideCanvas" >
                <div class="btn-group btn-group-justified" id="bt1" role="group" aria-label="...">
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-default"><span class="glyphicon glyphicon-record" aria-hidden="false"></span></button>
                    </div>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-default"><span class="glyphicon glyphicon-registration-mark" aria-hidden="true"></span></button>
                    </div>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-default"><span class="glyphicon glyphicon-rub" aria-hidden="true"></span></button>
                    </div>
                </div><h4 id="headSide2">MODIFY</h4><div class="btn-group-vertical" role="group" aria-label="...">
                <button type="button" class="btn btn-default">Left</button>
                <button type="button" class="btn btn-default">Middle</button>
                <button type="button" class="btn btn-default">Right</button>
                <button type="button" class="btn btn-default">Right</button>
                <button type="button" class="btn btn-default">Right</button>
                <button type="button" class="btn btn-default">Right</button>
            </div></panel></div>
        </section>
    </div>
    <!--br-->
    <div class="list-group">
        <a href="#" class="list-group-item active">
            <h4 class="list-group-item-heading">This is a UAH Project Done by the SMAP Center</h4>
            <p class="list-group-item-text">...</p>
        </a>
    </div>

    <div class="panel-footer">Developed by: Jason Thomas, Telly Polychroniades, & Dr. William Sabados</div>
</div>
</body>
</html>
